<%- include ('./partials/header') %>

<link rel="stylesheet" href="/css/countrySelect.min.css">
<link rel="stylesheet" href="/css/bootstrap-colorpicker.min.css">

<div class="my-3 container-fluid">
    <div class="row justify-content-center text-center mx-auto">
        <div class="col-8 col-md-3 col-lg-2 mx-auto order-2 order-md-1">
            <div class="section" id="section1">
                <h5><%= text.SELECTED_NATIONS %>:</h5>
                <div>
                    <p class="delete-country" onclick="countryCheckbox(this)" id="<%= country.code %>">
                        <img src="/img/cross.svg" alt="Delete" style="max-width: 1rem;">
                        <img src="/img/flags/<%= country.code %>.png" alt="Flag" style="max-width: 1rem;">
                        <span class="country-name strike-link"><%= country.name %></span>
                    </p>
                </div>
            </div>
        </div>
        <div class="col-12 col-md-9 col-lg-10 mx-auto mb-3 order-1 order-md-2">
            <div class="section" id="section2">

                <!-- Header ultime statistiche -->
                <h1> <%= text.LATEST_STATS %></h1>

                <!-- Selezione nazione -->
                <input id="country_selector" type="text" autocomplete="off">

                <!-- Grafico -->
                <div class="chart-container mx-auto">
                    <canvas id="globalChart"></canvas>
                </div>

                <!-- Caricamento -->
                <div id="loading-container">
                    <div class="spinner-border" id="loading-spinner" role="status">
                        <span class="sr-only"><%= text.LOADING %></span>
                    </div>
                </div>

                <!-- Opzioni grafico -->
                <div class="row align-items-center justify-content-center mx-auto mb-2 mt-4 mx-2">
                    <div class="text-left col">
                        <p class="mb-1"><%= text.AXIS_TYPE %>:</p>
                        <div class="custom-control custom-radio">
                            <input type="radio" id="linearAxis" name="axisType" class="custom-control-input" value="linear" checked>
                            <label class="custom-control-label" for="linearAxis"><%= text.LINEAR %></label>
                        </div>
                        <div class="custom-control custom-radio">
                            <input type="radio" id="logarithmicAxis" name="axisType" class="custom-control-input" value="logarithmic">
                            <label class="custom-control-label" for="logarithmicAxis"><%= text.LOGARITHMIC %></label>
                        </div>
                    </div>
                    <div class="text-left col">
                        <p class="mb-1"><%= text.GRAPH_TYPE %>:</p>
                        <div class="custom-control custom-radio">
                            <input type="radio" id="lineChart" name="chartType" class="custom-control-input" value="line" checked>
                            <label class="custom-control-label" for="lineChart"><%= text.LINE %></label>
                        </div>
                        <div class="custom-control custom-radio">
                            <input type="radio" id="barChart" name="chartType" class="custom-control-input" value="bar">
                            <label class="custom-control-label" for="barChart"><%= text.BAR %></label>
                        </div>
                    </div>
                    <div class="col">
                        <div class="custom-control custom-checkbox pb-2">
                            <input type="checkbox" class="custom-control-input" id="datasetBackground">
                            <label class="custom-control-label" for="datasetBackground"><%= text.DATASET_BACKGROUND %></label>
                        </div>
                        <div style="display: inline;" id="chartBackgroundDiv" class="pt-1">
                            <label for="chartBackground" style="line-height: 1.2;"><%= text.CHART_BACKGROUND_COLOR %>: </label>
                            <input id="chartBackground" class="form-control" type="text" value="#FFFFFF" style="display: inline; max-width: 5rem; overflow: hidden;">
                        </div>
                    </div>
                    <div class="col">
                        <button type="button" class="btn btn-light mb-2" id="resetZoom"><%= text.ZOOM_RESET %></button>
                        <a href="#" role="button" class="btn btn-dark" id="saveAsImage"><%= text.SAVE_AS_IMAGE %></a>
                    </div>
                </div>

                <!-- Paragrafi invisibili da EJS a JavaScript -->
                <p id="stats-p" style="display: none;"><%= stats %></p>
                <p id="texts" style="display: none;"><%= JSON.stringify(text) %></p>

            </div>
        </div>
    </div>
</div>
<%- include ('./partials/footer') %>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@0.7.4"></script>
<script src="/js/countrySelect.min.js"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/split.js/1.5.11/split.min.js"></script> -->
<script>
    var localCountry = { name: "<%= country.name %>", code: "<%= country.code %>" };
</script>
<script src="/js/bootstrap-colorpicker.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.2/dist/FileSaver.min.js"></script>
<script src="/js/homepage.js"></script>